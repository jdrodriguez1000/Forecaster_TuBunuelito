============================= test session starts =============================
platform win32 -- Python 3.12.10, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\USUARIO\Documents\Forecaster\Tu_Bunuelito\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\USUARIO\Documents\Forecaster\Tu_Bunuelito
configfile: pytest.ini
plugins: anyio-4.12.1
collecting ... collected 5 items

tests/unit/test_loader.py::TestDataLoader::test_run_extraction_first_time_success PASSED [ 20%]
tests/unit/test_loader.py::TestDataLoader::test_run_extraction_incremental_success FAILED [ 40%]
tests/unit/test_loader.py::TestDataLoader::test_fetch_table_pagination PASSED [ 60%]
tests/unit/test_loader.py::TestDataLoader::test_get_preview PASSED       [ 80%]
tests/unit/test_loader.py::TestDataLoader::test_init_path_creation PASSED [100%]Report saved to tests/reports\unit_tests_latest.json and tests/reports\history\unit_tests_20260226_141406.json


================================== FAILURES ===================================
___________ TestDataLoader.test_run_extraction_incremental_success ____________

args = (<test_loader.TestDataLoader object at 0x000001E12C1DD640>,)
keywargs = {'mock_config': {'extractions': {'schemas': {'clima': {'fecha': 'datetime', 'temp': 'float'}, 'ventas': {'fecha': 'dat...ima']}, 'general': {'data_raw_path': 'data/01_raw', 'outputs_path': 'outputs', 'tests_reports_path': 'tests/reports'}}}

    @wraps(func)
    def patched(*args, **keywargs):
>       with self.decoration_helper(patched,
                                    args,
                                    keywargs) as (newargs, newkeywargs):

..\..\..\AppData\Local\Programs\Python\Python312\Lib\unittest\mock.py:1393: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
..\..\..\AppData\Local\Programs\Python\Python312\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
..\..\..\AppData\Local\Programs\Python\Python312\Lib\unittest\mock.py:1375: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\AppData\Local\Programs\Python\Python312\Lib\contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
..\..\..\AppData\Local\Programs\Python\Python312\Lib\unittest\mock.py:1451: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
..\..\..\AppData\Local\Programs\Python\Python312\Lib\pkgutil.py:513: in resolve_name
    mod = importlib.import_module(modname)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

name = 'pd', package = None

    def import_module(name, package=None):
        """Import a module.
    
        The 'package' argument is required when performing a relative import. It
        specifies the package to use as the anchor point from which to resolve the
        relative import to an absolute import.
    
        """
        level = 0
        if name.startswith('.'):
            if not package:
                raise TypeError("the 'package' argument is required to perform a "
                                f"relative import for {name!r}")
            for character in name:
                if character != '.':
                    break
                level += 1
>       return _bootstrap._gcd_import(name[level:], package, level)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       ModuleNotFoundError: No module named 'pd'

..\..\..\AppData\Local\Programs\Python\Python312\Lib\importlib\__init__.py:90: ModuleNotFoundError
=========================== short test summary info ===========================
FAILED tests/unit/test_loader.py::TestDataLoader::test_run_extraction_incremental_success
========================= 1 failed, 4 passed in 1.13s =========================
